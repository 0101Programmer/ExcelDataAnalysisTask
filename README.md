<h1>Задача по обработке данных из таблицы в формате Excel</h1>
<h2>Описание</h2>
<p>Период наблюдения - 5 месяцев.<br>Представленные данные:</p>

<h3>Таблица Сотрудники:</h3>
1)	Период - формат Дата (пропуски не допускаются)<br>
2)	ID должности - целое число (пропуски не допускаются, уникальный на каждый период)<br>
3)	Табельный номер - целое число (допускаются пропуски)<br>
4)	Город - Текст (допускаются пропуски)<br>
5)	Должность - Текст (допускаются пропуски)<br>
6)	ФИО - Текст (допускаются пропуски)

<h3>Таблица Города:</h3>
1)	Федеральный округ - Текст (пропуски не допускаются)<br>
2)	Регион - Текст (пропуски не допускаются)<br>
3)	Город - Текст (уникальный)

<h3>Задачи:</h3>
1. Предобработка таблицы:<br>
1.1. Исправить ошибки данных (некорректный для поля тип данных, дубликат и пр.)<br>
1.2. Часть данных по некоторым должностям была утеряна, но известно, что ID имеет уникальную должность и локацию, и не меняется из периода в период, восстановить недостающие данные<br>
1.3. Вытянуть строки с новыми штатными единицами, на которые еще не распределены должности и сотрудники. В графах Табельного номера и Должности проставить признак «Резерв»;<br>
2. Построить сводную таблицу с разбивкой по месяцам со следующими показателями:<br>
2.1. Количество действующих сотрудников (должностей);<br>
2.2. Количество свободных должностей (подсказка: табельный номер пустой);<br>
2.3. Доля свободных должностей от итого должностей;<br>
3. Работа по дополнению предобработанной таблицы, добавить следующие показатели:<br>
3.1. Федеральные округа и Регионы;<br>
3.2. Количество месяцев поиска сотрудника по должности накопительно по каждому месяцу (н-р должность "директор" не заполнена в январе до марта включительно, а в апреле заполнена, результат получится следующим: январь - 1, февраль - 2, март - 3).<br>
4. Ответить на следующие вопросы, построив сводные таблицы исходя из дополненных данных пункта 3;<br>
4.1. В каких городах наблюдается нехватка кадров на последний месяц? Отсортировать по убыванию;<br>
4.2. В каком регионе работает наибольшее количество сотрудников на последний месяц? Отсортировать по убыванию;<br>
4.3. Какие должности подвержены наибольшей текучести? Вывести наименование должности и коэффициенты текучести по месяцам, отразить первыми те должности, по которым наблюдалась наибольшая текучесть.<br>
5. Визуализация;<br>
5.1. Количество действующих сотрудников по Федеральным округам;<br>
5.2. Количество свободных должностей по регионам.

<h2>Пояснение</h2>
<h3>Предподготовка данных</h3>
<p>Перед анализом данных необходимо конвертировать их в удобный формат, например в датафрейм из библиотеки Pandas.</p>

![Снимок экрана 2025-02-16 133151](https://github.com/user-attachments/assets/9be22011-1ac5-479f-b25c-e93a4210a571)

<p>Исходная таблица по сотрудникам:</p>

![Снимок экрана 2025-02-16 135028](https://github.com/user-attachments/assets/f7487696-1cfa-4ffc-95b4-54ea6e648d88)
![Снимок экрана 2025-02-16 135034](https://github.com/user-attachments/assets/9b578aa2-b4f5-4764-9c4b-ddc949b93d9e)

<p>Исходная таблица по городам:</p>

![Снимок экрана 2025-02-16 135234](https://github.com/user-attachments/assets/bae17c05-cd51-4300-bcc8-32e2f7491366)


<h3>1. Предобработка таблицы</h3>
<h3>1.1. Исправить ошибки данных (некорректный для поля тип данных, дубликат и пр.)</h3>
<p>1) форматирование данных по сотрудникам</p>

<hr>

<p>Форматирование поля "Период" из формата excel в привычную дату, исключение пропусков</p>

![Снимок экрана 2025-02-16 133545](https://github.com/user-attachments/assets/7dc3a230-11ff-4dff-8f7d-3f375a08b840)

<p>Форматирование поля "ID должности" в строковый тип данных, удаление из поля всех буквенных обозначений, удаление пропусков; форматирование поля "Табельный номер" в тип данных "целое число"</p>

![Снимок экрана 2025-02-16 133817](https://github.com/user-attachments/assets/eabe26fc-c23c-47cd-a2c1-51e0724be7b5)

<hr>

<p>2) форматирование данных по городам</p>
<p>Сначала убираются все пропуски в столбцах Федеральный округ и Регион; затем убираются все дубликаты значений в столбце Город</p>

![Снимок экрана 2025-02-16 134012](https://github.com/user-attachments/assets/5507038d-3977-468f-9eba-c2d111931835)

<h3>1.2. Часть данных по некоторым должностям была утеряна, но известно, что ID имеет уникальную должность и локацию, и не меняется из периода в период, восстановить недостающие данные</h3>
<p>Восстановление значений "Должность" и "Локация" по "ID должности" в каждом периоде</p>

![Снимок экрана 2025-02-16 134624](https://github.com/user-attachments/assets/52864be9-a751-4b2f-9aab-c8d836036e48)

<p>Предобработанная таблица по сотрудникам:</p>

![Снимок экрана 2025-02-16 134837](https://github.com/user-attachments/assets/08f83836-8bed-43f1-90dc-f6c1332a9f59)
![Снимок экрана 2025-02-16 134847](https://github.com/user-attachments/assets/75646568-8ddf-4c32-a8c9-da7bfd1a11cb)

<p>Предобработанная таблица по городам:</p>

![Снимок экрана 2025-02-16 135651](https://github.com/user-attachments/assets/e7b4a656-107d-443a-8089-d14909c3eaae)

<h3>1.3. Вытянуть строки с новыми штатными единицами, на которые еще не распределены должности и сотрудники. В графах Табельного номера и Должности проставить признак «Резерв»</h3>

![Снимок экрана 2025-02-16 135423](https://github.com/user-attachments/assets/3899ef31-2468-4808-b0dc-dc47d78d7b76)

<p>Получившаяся таблица:</p>

![Снимок экрана 2025-02-16 135524](https://github.com/user-attachments/assets/9da29f03-7658-4f8e-a8d6-8625cbb79b0d)

<h3>
  2. Построить сводную таблицу с разбивкой по месяцам со следующими показателями:<br>
  2.1. Количество действующих сотрудников (должностей);<br>
  2.2. Количество свободных должностей (подсказка: табельный номер пустой);<br>
  2.3. Доля свободных должностей от итого должностей;<br>
</h3>

![Снимок экрана 2025-02-16 135914](https://github.com/user-attachments/assets/0b95f01c-c5de-42bd-855e-5e8ccc785da3)

<p>Итоговая сводная таблица:</p>

![Снимок экрана 2025-02-16 135951](https://github.com/user-attachments/assets/ae6dbf9c-9ae0-49b8-8c25-67ac6c577669)

<h3>
  3. Работа по дополнению предобработанной таблицы, добавить следующие показатели:<br>
  3.1. Федеральные округа и Регионы;<br>
  3.2. Количество месяцев поиска сотрудника по должности накопительно по каждому месяцу (н-р должность "директор" не заполнена в январе до марта включительно, а в апреле заполнена, результат получится следующим: январь - 1, февраль - 2, март - 3).<br>
</h3>

![Снимок экрана 2025-02-16 140215](https://github.com/user-attachments/assets/6c53c96f-ccbe-4f10-b776-9392bfb998f5)

<p>Взгляд на таблицу:</p>

![Снимок экрана 2025-02-16 140405](https://github.com/user-attachments/assets/b33fe64c-de8d-4ba6-ab65-0c8b1387a351)

![Снимок экрана 2025-02-16 140412](https://github.com/user-attachments/assets/b94209d8-9f98-4e7d-8526-d7423c9bdeb3)

![Снимок экрана 2025-02-16 140422](https://github.com/user-attachments/assets/4bdd4107-519f-43f9-9274-c216e493b82d)

![Снимок экрана 2025-02-16 140435](https://github.com/user-attachments/assets/aa56b47d-3cf4-4a23-9601-c8619f53dba2)

<h3>
  4. Ответить на следующие вопросы, построив сводные таблицы исходя из дополненных данных пункта 3;<br>
  4.1. В каких городах наблюдается нехватка кадров на последний месяц? Отсортировать по убыванию;<br>
  4.2. В каком регионе работает наибольшее количество сотрудников на последний месяц? Отсортировать по убыванию;<br>
  4.3. Какие должности подвержены наибольшей текучести? Вывести наименование должности и коэффициенты текучести по месяцам, отразить первыми те должности, по которым наблюдалась наибольшая текучесть.<br>
</h3>

<p>Сортировка городов, в которых наблюдается нехватка кадров на последний месяц, по убыванию:</p>

![Снимок экрана 2025-02-16 140901](https://github.com/user-attachments/assets/f0f361dd-554b-47f0-bf8b-aaa0780080c7)

![Снимок экрана 2025-02-16 140916](https://github.com/user-attachments/assets/4e531693-ab89-4864-acd1-032986cd2bb6)

<p>Сортировка регионов, в которых работает наибольшее количество сотрудников на последний месяц, по убыванию:</p>

![Снимок экрана 2025-02-16 184306](https://github.com/user-attachments/assets/63659e70-9764-43bc-94b2-a3a667f203ab)

![Снимок экрана 2025-02-16 184352](https://github.com/user-attachments/assets/11d14af3-6292-4f36-92d0-b1c7a27d4967)

![Снимок экрана 2025-02-16 184346](https://github.com/user-attachments/assets/afd8c044-c682-451e-91ce-a3b3d5e49d78)

<p>Анализ должностей по коэффициенту текучести по месяцам:</p>

![Снимок экрана 2025-02-16 184606](https://github.com/user-attachments/assets/19b05711-efae-4c82-85f6-bba4744a4306)

![Снимок экрана 2025-02-16 184614](https://github.com/user-attachments/assets/d6e180e9-964a-4fd0-894f-9c20b43710a9)

![Снимок экрана 2025-02-16 184653](https://github.com/user-attachments/assets/e5e22d80-a3ce-4ae8-8719-9737199d3b38)<br> и т.д. вниз по убыванию

<h3>
  5. Визуализация;<br>
  5.1. Количество действующих сотрудников по Федеральным округам;<br>
  5.2. Количество свободных должностей по регионам.
</h3>

![Снимок экрана 2025-02-16 184931](https://github.com/user-attachments/assets/026e6692-eeaa-45db-a897-232f0cdf2ead)

![Снимок экрана 2025-02-16 184954](https://github.com/user-attachments/assets/56c07330-b255-45c2-a9a7-ef6b91bacd81)

<hr>

![Снимок экрана 2025-02-16 185102](https://github.com/user-attachments/assets/6e7cb3ad-d09a-45e2-9fa8-61b3a04d2df1)

![Снимок экрана 2025-02-16 185136](https://github.com/user-attachments/assets/a023666c-37a4-44db-8efb-15c24ec69859)

